@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = " Danh sách  khóa học";
}
@model DoAnCoSo_Web.Areas.Staff.ViewModels.KhoaHocIndexViewModel


<a asp-action="Index" asp-controller="StaffHome" class="btn btn-secondary mb-3">Quay lại</a>
<title>@ViewData["Title"]</title>
<h2>@ViewData["Title"]</h2>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/2.2.2/css/dataTables.bootstrap5.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<style>
	/* Căn trái tất cả nội dung trong bảng */
	#example td,
	#example th {
		text-align: left !important;
	}
</style>

<table id="example" class="table table-striped" style="width:100%">
	<thead class="table-dark">
		<tr>
			<th>Tên khóa học </th>
			<th>Học Phí</th>
			<th>Ngày học</th>
			<th>Giờ bắt đầu</th>
			<th>Giờ kết thúc</th>
			<th>Chức năng</th>
			
		</tr>
	</thead>
	<tbody>
		@foreach (var item in Model.dsKhoaHoc)
		{
			<tr>
				<td>@item.TenKhoaHoc</td>
				<td>@item.HocPhi.ToString("N0") VND</td>
				<td>@item.NgayHoc</td>
				<td>@item.GioBatDau.Split('.')[0]</td>
				<td>@item.GioKetThuc.Split('.')[0]</td>
				<td>
					<a asp-area="Staff" asp-controller="KhoaHoc" asp-action="Edit" asp-route-id="@item.MaKhoaHoc" class="btn btn-outline-primary fw-bold rounded-pill shadow-sm">
						<i class="fa-solid fa-pen-to-square"></i>Sửa
					</a>
					<button class="btn btn-danger fw-bold rounded-pill shadow-sm delete-btn" onclick="xoa(@item.MaKhoaHoc,this)">
						<i class="fa-solid fa-trash"></i> Xóa
					</button>
					<a asp-area="Staff" asp-controller="KHoaHoc" asp-action="Detail" asp-route-id="@item.MaKhoaHoc" class="btn btn-outline-info fw-bold rounded-pill shadow-sm">
						<i class="fa-solid fa-circle-info"></i> Xem chi tiết
					</a>

				</td>
			</tr>
		}
	</tbody>
</table>
<a href="@Url.Action("Create")" class="btn btn-primary">+ Thêm khóa học</a>
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/2.2.2/js/dataTables.js"></script>
<script src="https://cdn.datatables.net/2.2.2/js/dataTables.bootstrap5.js"></script>
<script>
	new DataTable('#example',{
		pageLength: 5,
		 lengthChange: false,
		 columnDefs: [
		{ targets: 0, searchable: true },
		{ targets: [1, 2], searchable: false }
	  ],
		language: {
			search: "Tìm kiếm:",
			 lengthMenu: "Hiển thị _MENU_ dòng",
			info: "Hiển thị _START_ đến _END_ của _TOTAL_ dòng",
			paginate: {
				previous: "Trước",
				next: "Sau"
			},
			zeroRecords: "Không tìm thấy kết quả phù hợp"
		}
	});
	 function xoa(id, element) {
		if (!confirm("Bạn có chắc chắn muốn xóa khóa học này không?")) {
			return;
		}

		$.ajax({
			url: `/Staff/KhoaHoc/Delete`,  // Thay đổi URL đúng với action Delete của controller KhoaHoc
			type: "POST",
			data: { id: id },
			success: function (response) {
				if (response.success) {
					// Ẩn dòng chứa khóa học (row trong table)
					$(element).closest("tr").fadeOut(500, function () {
						$(this).remove();
					});
				} else {
					alert("Không thể xóa khóa học này!");
				}
			},
			error: function () {
				alert("Lỗi khi xóa khóa học!");
			}
		});
	}
</script>
